# 前端改造计划与进度

## 📋 总体架构

### 设计原则
1. **代码复用**：不同角色共享相同功能组件，通过权限控制显示差异
2. **权限驱动**：基于角色的权限控制（RBAC）
3. **渐进式实现**：先基础架构，再业务功能

### 目录结构
```
frontend/src/
├── constants/
│   └── permissions.ts          # 权限常量定义 ✅
├── utils/
│   └── permission.ts            # 权限工具函数 ✅
├── layouts/
│   ├── MainLayout.vue           # 共享主布局 ✅
│   └── components/
│       └── SideMenu.vue         # 侧边栏菜单 ✅
├── views/
│   ├── system/                  # 系统管理（仅管理员）
│   │   ├── Users.vue            # 用户管理
│   │   ├── Roles.vue            # 角色管理
│   │   ├── Permissions.vue      # 权限管理
│   │   └── Menus.vue            # 菜单管理
│   ├── teaching/                # 教学管理（多角色共享）
│   │   ├── SchoolList.vue       # 学校列表
│   │   ├── ClassroomList.vue    # 教室列表
│   │   ├── CourseList.vue       # 课程列表（根据权限过滤）
│   │   ├── StudentList.vue      # 学员列表（根据权限过滤）
│   │   ├── TeacherList.vue      # 教师列表
│   │   ├── HomeworkGrading.vue  # 作业批改
│   │   ├── HomeworkPublish.vue  # 作业发布
│   │   └── DailyReports.vue     # 日报
│   ├── employment/              # 就业管理（多角色共享）
│   │   ├── CompanyList.vue      # 企业列表
│   │   ├── PositionList.vue     # 岗位列表
│   │   ├── ApplicationList.vue  # 求职申请
│   │   ├── WrittenTest.vue      # 笔试
│   │   ├── Interview.vue        # 面试
│   │   └── Statistics.vue       # 统计
│   └── profile/
│       └── Profile.vue          # 个人中心
```

---

## ✅ 已完成

### 1. 权限系统基础
- ✅ 创建权限常量定义 (`src/constants/permissions.ts`)
  - 系统管理权限（用户、角色、权限、菜单）
  - 教学管理权限（学校、教室、课程、学员、教师、作业、日报）
  - 就业管理权限（企业、岗位、申请、笔试、面试、统计）
  - 角色权限映射（admin, college_head, teacher, user, enterprise_contact）

- ✅ 创建权限工具函数 (`src/utils/permission.ts`)
  - `hasPermission(permission)` - 检查是否有某个权限
  - `hasAnyPermission(permissionList)` - 检查是否有任意一个权限
  - `hasAllPermissions(permissionList)` - 检查是否有所有权限
  - `hasRole(role)` - 检查是否是某个角色
  - `hasAnyRole(roleList)` - 检查是否是某些角色中的任意一个
  - `permissionDirective` - Vue权限指令
  - `roleDirective` - Vue角色指令

### 2. 布局系统
- ✅ 创建共享主布局 (`src/layouts/MainLayout.vue`)
  - 响应式侧边栏（支持折叠/展开）
  - 顶部栏（标题、角色标签、通知、用户下拉菜单）
  - 路由切换动画
  - 退出登录功能

- ✅ 创建侧边栏菜单组件 (`src/layouts/components/SideMenu.vue`)
  - 基于角色的动态菜单
  - 支持多级菜单
  - 菜单权限控制

---

## 🚧 进行中

### 3. 路由系统重构
- ⏳ 重构路由配置
- ⏳ 创建路由守卫（权限验证）
- ⏳ 实现路由懒加载

---

## 📝 待办事项

### 阶段二：系统管理模块（仅管理员）
- [ ] 用户管理页面
  - [ ] 用户列表（搜索、分页、增删改查）
  - [ ] 用户详情/编辑弹窗
  - [ ] 集成用户API

- [ ] 角色管理页面
  - [ ] 角色列表
  - [ ] 角色权限分配界面
  - [ ] 集成角色API

- [ ] 权限管理页面
  - [ ] 权限列表
  - [ ] 权限树形展示
  - [ ] 集成权限API

- [ ] 菜单管理页面
  - [ ] 菜单列表
  - [ ] 菜单树形编辑器
  - [ ] 菜单图标选择

### 阶段三：教学管理模块（多角色共享）
- [ ] 学校管理
  - [ ] 学校列表（根据权限过滤）
  - [ ] 学校详情/编辑
  - [ ] 学校Logo上传

- [ ] 教室管理
  - [ ] 教室列表
  - [ ] 教室预约功能
  - [ ] 教室状态可视化

- [ ] 课程管理
  - [ ] 课程列表（根据权限过滤）
  - [ ] 课程详情
  - [ ] 课程发布/编辑
  - [ ] 课程章节管理

- [ ] 学员管理
  - [ ] 学员列表（根据权限过滤）
  - [ ] 学员信息管理
  - [ ] 学习进度追踪

- [ ] 教师管理
  - [ ] 教师列表
  - [ ] 教师信息管理
  - [ ] 教师课程安排

- [ ] 作业批改管理
  - [ ] 作业列表（根据权限过滤）
  - [ ] 作业批改界面
  - [ ] 批改记录查看

- [ ] 作业/考试发布
  - [ ] 作业发布页面
  - [ ] 考试发布页面
  - [ ] 富文本编辑器
  - [ ] 附件上传

- [ ] 日报管理
  - [ ] 日报列表
  - [ ] 日报提交界面
  - [ ] 日报审阅功能

### 阶段四：就业管理模块（多角色共享）
- [ ] 企业管理
  - [ ] 企业列表
  - [ ] 企业详情/编辑
  - [ ] 企业认证

- [ ] 岗位管理
  - [ ] 岗位列表（根据权限过滤）
  - [ ] 岗位发布/编辑
  - [ ] 岗位推荐

- [ ] 求职管理
  - [ ] 申请列表（根据权限过滤）
  - [ ] 申请状态流转
  - [ ] 面试安排

- [ ] 笔试管理
  - [ ] 笔试列表
  - [ ] 题目管理
  - [ ] 在线笔试

- [ ] 面试管理
  - [ ] 面试列表
  - [ ] 面试安排
  - [ ] 面试评价

- [ ] 统计分析
  - [ ] 就业统计页面（根据角色显示不同数据）
  - [ ] 数据可视化

### 阶段五：个人中心
- [ ] 个人信息管理
- [ ] 密码修改
- [ ] 消息通知

### 阶段六：优化与测试
- [ ] 性能优化
- [ ] 用户体验优化
- [ ] 测试

---

## 🔧 权限使用示例

### 在组件中使用权限检查

```vue
<script setup lang="ts">
import { hasPermission, hasRole } from '@/utils/permission'

// 检查是否有编辑用户权限
const canEditUser = hasPermission('system:user:edit')

// 检查是否是管理员
const isAdmin = hasRole('admin')
</script>

<template>
  <!-- 根据权限显示按钮 -->
  <el-button v-if="canEditUser" type="primary">编辑用户</el-button>

  <!-- 根据角色显示内容 -->
  <div v-if="isAdmin">这是管理员专属内容</div>
</template>
```

### 使用权限指令

```vue
<template>
  <!-- 单个权限 -->
  <el-button v-permission="'system:user:add'">新增用户</el-button>

  <!-- 多个权限（满足任意一个） -->
  <div v-permission.any="['system:user:edit', 'system:user:delete']">
    可以编辑或删除用户
  </div>

  <!-- 多个权限（需要全部满足） -->
  <div v-permission.all="['system:user:edit', 'system:user:view']">
    可以查看和编辑用户
  </div>

  <!-- 角色指令 -->
  <div v-role="'admin'">管理员专属</div>

  <!-- 多个角色 -->
  <div v-role="['admin', 'college_head']">
    管理员和学院负责人可见
  </div>
</template>
```

---

## 📊 角色权限速查表

| 功能 | 管理员 | 学院负责人 | 教师 | 学员 | 企业对接人 |
|------|--------|-----------|------|------|-----------|
| 用户管理 | ✅完全控制 | ❌ | ❌ | ❌ | ❌ |
| 角色管理 | ✅完全控制 | ❌ | ❌ | ❌ | ❌ |
| 权限管理 | ✅完全控制 | ❌ | ❌ | ❌ | ❌ |
| 菜单管理 | ✅完全控制 | ❌ | ❌ | ❌ | ❌ |
| 学校管理 | ✅所有学校 | ✅本校 | ❌ | ❌ | ❌ |
| 教室管理 | ✅所有教室 | ✅本校教室 | ✅查看+预约 | ❌ | ❌ |
| 课程管理 | ✅所有课程 | ✅本校课程 | ✅自己的课程 | ✅已选课程 | ❌ |
| 学员管理 | ✅所有学员 | ✅本校学员 | ✅班级学员 | ✅自己 | ❌ |
| 教师管理 | ✅所有教师 | ✅本校教师 | ❌ | ❌ | ❌ |
| 作业批改 | ✅所有作业 | ✅本校作业 | ✅批改自己的 | ✅查看自己的 | ❌ |
| 作业发布 | ✅发布所有 | ✅发布全校 | ✅发布自己的 | ❌ | ❌ |
| 日报管理 | ✅查看所有 | ✅查看+审阅本校 | ✅提交 | ✅提交 | ❌ |
| 企业管理 | ✅所有企业 | ❌ | ❌ | ❌ | ✅自己的企业 |
| 岗位管理 | ✅所有岗位 | ✅查看所有 | ✅查看所有 | ✅投递 | ✅管理自己的 |
| 求职管理 | ✅所有申请 | ✅本校申请 | ✅班级申请 | ✅自己的申请 | ✅处理本企业 |
| 笔试管理 | ✅所有笔试 | ❌ | ✅参与组织 | ✅参加 | ✅组织 |
| 面试管理 | ✅所有面试 | ✅本校面试 | ✅参与组织 | ✅参加 | ✅组织 |
| 统计 | ✅全局统计 | ✅本校统计 | ✅班级统计 | ❌ | ✅企业统计 |

---

## 📝 下一步计划

1. 注册权限指令到Vue应用（在 main.ts 中）
2. 重构路由配置，添加权限守卫
3. 开始创建管理员功能页面（从用户管理开始）
4. 逐步完成其他模块

---

## 🎯 设计亮点

1. **高度复用**：同一套组件，不同角色看到不同内容
2. **权限精细**：支持到功能点的权限控制
3. **易于扩展**：新增角色或权限只需配置
4. **代码简洁**：减少重复代码，提高可维护性

---

*文档更新时间：2026-01-13*
